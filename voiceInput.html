<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Voice Input</title>
</head>
<body>
  <h3>Listening...</h3>
  <script>
    function startDictation() {
      if (!('webkitSpeechRecognition' in window)) {
        window.opener.postMessage({ type: 'error', message: 'Speech recognition not supported.' }, '*');
        return;
      }

      const recognition = new webkitSpeechRecognition();
      recognition.continuous = false;
      recognition.interimResults = false;
      recognition.lang = 'en-US';

      recognition.onresult = function(event) {
        const transcript = event.results[0][0].transcript;
        window.opener.postMessage({ type: 'speech-result', transcript }, '*');
        window.close();
      };

      recognition.onerror = function(event) {
        window.opener.postMessage({ type: 'error', message: event.error }, '*');
        window.close();
      };

      recognition.start();
    }

    startDictation();
  </script>
</body>
</html>
